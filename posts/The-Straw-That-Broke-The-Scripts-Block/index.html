<!DOCTYPE html><html lang="en" mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="The Straw That Broke The Scripts Block" /><meta property="og:locale" content="en" /><meta name="description" content="This is a reminder to be mindful when copying and pasting code from an external source. I’ve been putting InjectionHunter to use and encountered “the straw that broke the camel’s back script’s block.” It shows how well designed this module is (thanks @Lee_Holmes!)" /><meta property="og:description" content="This is a reminder to be mindful when copying and pasting code from an external source. I’ve been putting InjectionHunter to use and encountered “the straw that broke the camel’s back script’s block.” It shows how well designed this module is (thanks @Lee_Holmes!)" /><link rel="canonical" href="https://aarontheadmin.github.io/posts/The-Straw-That-Broke-The-Scripts-Block/" /><meta property="og:url" content="https://aarontheadmin.github.io/posts/The-Straw-That-Broke-The-Scripts-Block/" /><meta property="og:site_name" content="Aaron the Admin" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-09-04T00:00:00-07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="The Straw That Broke The Scripts Block" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"headline":"The Straw That Broke The Scripts Block","dateModified":"2018-09-04T00:00:00-07:00","datePublished":"2018-09-04T00:00:00-07:00","description":"This is a reminder to be mindful when copying and pasting code from an external source. I’ve been putting InjectionHunter to use and encountered “the straw that broke the camel’s back script’s block.” It shows how well designed this module is (thanks @Lee_Holmes!)","url":"https://aarontheadmin.github.io/posts/The-Straw-That-Broke-The-Scripts-Block/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://aarontheadmin.github.io/posts/The-Straw-That-Broke-The-Scripts-Block/"},"@context":"https://schema.org"}</script><title>The Straw That Broke The Scripts Block | Aaron the Admin</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Aaron the Admin"><meta name="application-name" content="Aaron the Admin"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> </a></div><div class="site-title mt-3"> <a href="/">Aaron the Admin</a></div><div class="site-subtitle font-italic">Automating Microsoft-or-not</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/aarontheadmin" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.linkedin.com/in/aarontheadmin" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>The Straw That Broke The Scripts Block</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>The Straw That Broke The Scripts Block</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Aaron Hardy </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Sep 4, 2018, 12:00 AM -0700" >Sep 4, 2018<i class="unloaded">2018-09-04T00:00:00-07:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="349 words">1 min read</span></div></div><div class="post-content"><p>This is a reminder to be mindful when copying and pasting code from an external source. I’ve been putting InjectionHunter to use and encountered “the straw that broke the <del>camel’s back</del> script’s block.” It shows how well designed this module is (thanks <a href="https://twitter.com/Lee_Holmes">@Lee_Holmes!</a>)</p><div class="table-wrapper"><table><thead><tr><th>Straw<th>Script block<tbody><tr><td>part of the decrement operator <code class="language-powershell highlighter-rouge"><span class="o">--</span></code><td>a <code class="language-powershell highlighter-rouge"><span class="kr">for</span><span class="p">()</span></code> loop</table></div><p>I decided to give InjectionHunter a whirl against a script module I wrote for Wirecast on macOS, but my playground for this was my Windows laptop with a current version of the module. Out of many, many script files, three items came up with the Severity of “Warning” and it ended with a ParseException. Really? InjectionHunter is bugged! Nope.</p><p>The ParseException was thrown once InjectionHunter hit a script file, Start-Countdown.ps1 (it counts backwards based on the time you specify):</p><p><img data-proofer-ignore data-src="https://aarontheadmin.github.io/assets/img/parseexception.png" alt="ParseException caught by InjectionHunter caused by incorrect decrement character in for loop" title="ParseException Caught by InjectionHunter" /></p><p>There were a few errors after this but for brevity sake, only the first one is shown here.</p><p>This ParseError was obviously pointing to one or more conflicting characters but the strange thing was that this script has been used in production for quite a while and has never thrown exceptions like this; it just worked as expected.</p><p>Opening the script file in Visual Studio Code (in Windows), I found the straw. Glancing at the for() loop on line 28 (as per the ParseException) didn’t offer an obvious clue because everything appeared correct. But honing in on the decrement operator, the left “-“ is slightly longer in size than the right “-“:</p><p><img data-proofer-ignore data-src="https://aarontheadmin.github.io/assets/img/vscode-bad-char.png" alt="Visual Studio Code: For loop containing incorrect decrement character" title="Visual Studio Code: For loop containing incorrect decrement character" /></p><p>Copying and pasting into Notepad reflects the same thing:</p><p><img data-proofer-ignore data-src="https://aarontheadmin.github.io/assets/img/notepad.png" alt="Notepad - For loop containing incorrect decrement character" title="Notepad - For loop containing incorrect decrement character" /></p><p>It reminds me of the auto-formatting of hyphens in Microsoft Word when hitting a space afterwards. Clearly, there is no space added here.</p><p>By replacing this conflicting character with the correct one (manual typing), InjectionHunter completes without throwing the ParseException:</p><p><img data-proofer-ignore data-src="https://aarontheadmin.github.io/assets/img/fixed.png" alt="Visual Studio Code: For loop containing fixed decrement character" title="Visual Studio Code: For loop containing fixed decrement character" /></p><p><img data-proofer-ignore data-src="https://aarontheadmin.github.io/assets/img/injectionhunter-no-parseexception.png" alt="InjectionHunter - No ParseException" title="InjectionHunter - No ParseException" /></p><p>No more ParseException! With the correct-size straw, this <del>camel</del> script block can now function without a grunt.</p><p>So, whether you’re following someone else’s work or you copy/paste from an external source, always make sure the correct character set is used, and if you use InjectionHunter, maybe it will find anomalies like it did here.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/powershell/'>PowerShell</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/powershell/" class="post-tag no-text-decoration" >PowerShell,</a> <a href="/tags/injectionhunter/" class="post-tag no-text-decoration" >InjectionHunter,</a> <a href="/tags/macos/" class="post-tag no-text-decoration" >macOS,</a> <a href="/tags/windows/" class="post-tag no-text-decoration" >Windows,</a> <a href="/tags/visual/" class="post-tag no-text-decoration" >Visual</a> <a href="/tags/studio/" class="post-tag no-text-decoration" >Studio</a> <a href="/tags/code/" class="post-tag no-text-decoration" >Code,</a> <a href="/tags/characterset/" class="post-tag no-text-decoration" >characterset</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=The Straw That Broke The Scripts Block - Aaron the Admin&url=https://aarontheadmin.github.io/posts/The-Straw-That-Broke-The-Scripts-Block/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=The Straw That Broke The Scripts Block - Aaron the Admin&u=https://aarontheadmin.github.io/posts/The-Straw-That-Broke-The-Scripts-Block/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=The Straw That Broke The Scripts Block - Aaron the Admin&url=https://aarontheadmin.github.io/posts/The-Straw-That-Broke-The-Scripts-Block/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Get-All-Dates-In-A-Given-Month/">Get All Dates In A Given Month</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/core/">Core,</a> <a class="post-tag" href="/tags/powershell/">PowerShell</a> <a class="post-tag" href="/tags/macos/">macOS,</a> <a class="post-tag" href="/tags/macos/">macOS</a> <a class="post-tag" href="/tags/powershell/">PowerShell,</a> <a class="post-tag" href="/tags/code/">Code,</a> <a class="post-tag" href="/tags/studio/">Studio</a> <a class="post-tag" href="/tags/visual/">Visual</a> <a class="post-tag" href="/tags/windows/">Windows,</a> <a class="post-tag" href="/tags/windows/">Windows</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Use-PowerShell-Core-in-VS-Code/"><div class="card-body"> <span class="timeago small" >Feb 10, 2018<i class="unloaded">2018-02-10T00:00:00-08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Use PowerShell Core in VS Code</h3><div class="text-muted small"><p> The movement to PowerShell Core is gaining popularity, along with the wide-spreading use of Visual Studio Code; especially as Microsoft has confirmed Windows PowerShell will no longer have new rele...</p></div></div></a></div><div class="card"> <a href="/posts/OpenSSH-Remoting-Broken-After-PowerShell-Upgrade/"><div class="card-body"> <span class="timeago small" >Jun 5, 2018<i class="unloaded">2018-06-05T00:00:00-07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OpenSSH Remoting Broken After PowerShell Upgrade</h3><div class="text-muted small"><p> PowerShell Remoting in PowerShell Core has transformed the way Windows can communicate with other operating systems like Linux and macOS, and accomplish tasks using PowerShell and Bash as though yo...</p></div></div></a></div><div class="card"> <a href="/posts/Netstat-as-PowerShell-Objects-to-Identify-Port-Usage/"><div class="card-body"> <span class="timeago small" >Apr 4, 2018<i class="unloaded">2018-04-04T00:00:00-07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Netstat as PowerShell Objects to Identify Port Usage</h3><div class="text-muted small"><p> This post covers how to dump netstat output into Windows PowerShell objects for easier management and investigation purposes. This can be helpful if you’re trying to find out what port is being use...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Converting-Celsius-to-Fahrenheit-Vice-Versa/" class="btn btn-outline-primary" prompt="Older"><p>Converting Celsius to Fahrenheit Vice Versa</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://aarontheadmin.github.io/posts/The-Straw-That-Broke-The-Scripts-Block/'; this.page.identifier = '/posts/The-Straw-That-Broke-The-Scripts-Block/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (modeToggle !== null) { modeToggle.addEventListener('click', reloadDisqus); window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://github.com/aarontheadmin">Aaron Hardy</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/core/">Core,</a> <a class="post-tag" href="/tags/powershell/">PowerShell</a> <a class="post-tag" href="/tags/macos/">macOS,</a> <a class="post-tag" href="/tags/macos/">macOS</a> <a class="post-tag" href="/tags/powershell/">PowerShell,</a> <a class="post-tag" href="/tags/code/">Code,</a> <a class="post-tag" href="/tags/studio/">Studio</a> <a class="post-tag" href="/tags/visual/">Visual</a> <a class="post-tag" href="/tags/windows/">Windows,</a> <a class="post-tag" href="/tags/windows/">Windows</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
